<!DOCTYPE html>

<!-- Mockup of new WeeNAS admin interface. -->

<html lang="en-US">

<head>
  <title>File Shares</title>
  <meta charset="utf-8">
  <link href="common.css" rel="stylesheet" type="text/css">
  <script src="common.js"></script>
  <script>
    function displayServiceHealth(serviceHealth) {
      let tbody = '';
      tbody += `<tr><td>nmbd</td><td>${serviceHealth.nmbd.status}</td></tr>`;
      tbody += `<tr><td>smbd</td><td>${serviceHealth.smbd.status}</td></tr>`;
      tbody += `<tr><td>smb4.conf</td><td>${serviceHealth.smbconf.status}</td></tr>`;
      document.getElementById('smb-service-status').innerHTML = tbody;
    }

    function displaySmbShares(smbConfigShares) {
      let shareList = '<option selected>[New]</option>';
      for (let i = 0; i < smbConfigShares.length; i++) {
        shareList += `<option>${smbConfigShares[i]}</option>`;
      }
      document.getElementById('smb-share-list').innerHTML = shareList;
    }

    function getShareDetails(smbShare) {
      if (smbShare == "[New]") {
        document.getElementById('create-button').style.display='inline';
        document.getElementById('update-delete-buttons').style.display='none';
//        displaySmbShareDetails();
      }
      else {
        document.getElementById('create-button').style.display='none';
        document.getElementById('update-delete-buttons').style.display='inline';
//        AJAX('GET', '/smb/share/' + login, displaySmbShareDetails);
      }
    }
  </script>
</head>

<body
  onload="AJAX('GET', '/system/health/summary', displayServiceHealth); AJAX('GET', '/smb/config/shares', displaySmbShares);">
  <p class="caution">This is a partially functioning mock-up. Shares cannot be created or deleted.</p>
  <form>
    <fieldset>
      <legend>SMB Service Health</legend>
      <button class="refresh"
        onclick="AJAX('GET', '/system/health/summary', displayServiceHealth);"
        type="button">&#x1F504;</button>
      <table>
        <colgroup>
          <col style="width: 20%">
          <col>
        </colgroup>
        <tbody id="smb-service-status"></tbody>
      </table>
    </fieldset>

    <fieldset>
      <legend>Share Management</legend>
      <button class="refresh"
        onclick="AJAX('GET', '/system/smb/config/shares', displaySmbShares);"
        type="button">&#x1F504;</button>
      <table>
        <colgroup>
          <col style="width: 20%">
          <col>
        </colgroup>
        <thead>
          <tr><th>Share Name</th><th>Properties</th></tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="5">
              <select id="smb-share-list" onclick="getShareDetails(document.getElementById('smb-share-list').value)"
                id="smb-share-list" size="5" style="width: 85%;"></select>
            </td>
          </tr>
          <tr><td><input type="text" placeholder="share name"></td></tr>
          <tr><td><input type="text" placeholder="server path"></td></tr>
          <tr><td><input class="optional" type="text" placeholder="comment"></td></tr>
          <tr>
            <td>
              <input type="checkbox">&#x1F50D;<span class="collapsible"> browsable</span>
              <input type="checkbox">&#x270F;&#xFE0F;<span class="collapsible"> writable</span>
              <input type="checkbox">&#x026D4;<span class="collapsible"> unavailable</span>
            </td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <td colspan="2">
              <button id="create-button" onclick="alert('Pretending to create a share');" style="float: right;" type="button">
                &#x02705;<span class="collapsible">&nbsp;Create</span></button>
              <span id="update-delete-buttons" style="display: none; float: right;">
                <button onclick="alert('Pretending to update a share');" type="button">&#x1F4DD;<span class="collapsible">&nbsp;Update</span></button>
                <button onclick="alert('Pretending to delete a share');" type="button">&#x0274C;<span class="collapsible">&nbsp;Delete</span></button>
              </span>
            </td>
          </tr>
        </tfoot>
      </table>
    </fieldset>
  </form>
</body>

</html>